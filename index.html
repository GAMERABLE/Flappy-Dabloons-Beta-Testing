<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Flappy Dabloons</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      font-family: sans-serif;
      background-color: #87CEEB;
      text-align: center;
    }
    #intro {
      position: absolute;
      width: 100%;
      top: 30%;
      animation: fadeOut 3s ease-in-out 3s forwards;
    }
    #gameTitle {
      opacity: 0;
      font-size: 2em;
      animation: fadeIn 2s ease-in 6s forwards;
    }
    #playButton {
      display: none;
      font-size: 1.5em;
      margin-top: 10px;
      padding: 10px 20px;
    }
    canvas {
      display: none;
      background-color: #87CEEB;
    }
    #shop {
      display: none;
      margin-top: 20px;
      background: #fff;
      padding: 10px;
      border-radius: 8px;
    }
    .item {
      background: #eee;
      margin: 10px auto;
      padding: 10px;
      width: 250px;
    }

    @keyframes fadeOut {
      to { opacity: 0; }
    }

    @keyframes fadeIn {
      to { opacity: 1; }
    }
  </style>
</head>
<body>
  <div id="intro">
    <h1>GAMERABLE Studios presents to you…</h1>
    <h2 id="gameTitle">Flappy Dabloons</h2>
    <button id="playButton" onclick="startGame()">Play</button>
  </div>

  <canvas id="gameCanvas" width="400" height="600"></canvas>

  <div id="shop">
    <h3>Dabloon Shop</h3>
    <p>You have <span id="dabloonCount">50</span> Dabloons</p>
    <div class="item">
      <strong>Golden Bird</strong><br><em>Shiny and rare.</em><br>
      <button onclick="buySkin('gold')">Buy - 20 Dabloons</button>
    </div>
    <div class="item">
      <strong>Doge Flyer</strong><br><em>It’s a bird, it’s a plane… no, it’s a Doge?!</em><br>
      <button onclick="buySkin('doge')">Buy - 30 Dabloons</button>
    </div>
    <button onclick="restartGame()">Replay</button>
  </div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    let bird = { x: 80, y: 250, w: 20, h: 20, velocity: 0 };
    let gravity = 0.5;
    let pipes = [];
    let dabloons = 50;
    let gameRunning = false;
    let pipeGap = 140;
    let frame = 0;

    const dabloonCount = document.getElementById("dabloonCount");
    const playButton = document.getElementById("playButton");
    const gameTitle = document.getElementById("gameTitle");

    setTimeout(() => {
      gameTitle.style.display = "block";
    }, 3000);

    setTimeout(() => {
      playButton.style.display = "inline-block";
    }, 6000);

    function startGame() {
      document.getElementById("intro").style.display = "none";
      canvas.style.display = "block";
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      gameRunning = true;
      requestAnimationFrame(updateGame);
    }

    function drawBird() {
      ctx.fillStyle = "gold";
      ctx.fillRect(bird.x, bird.y, bird.w, bird.h);
    }

    function drawPipes() {
      ctx.fillStyle = "green";
      for (let pipe of pipes) {
        ctx.fillRect(pipe.x, 0, pipe.w, pipe.top);
        ctx.fillRect(pipe.x, canvas.height - pipe.bottom, pipe.w, pipe.bottom);
      }
    }

    function updatePipes() {
      if (frame % 100 === 0) {
        let top = Math.random() * (canvas.height / 2);
        let bottom = canvas.height - top - pipeGap;
        pipes.push({ x: canvas.width, w: 40, top, bottom });
      }

      for (let pipe of pipes) {
        pipe.x -= 2;

        // Collision
        if (
          bird.x < pipe.x + pipe.w &&
          bird.x + bird.w > pipe.x &&
          (bird.y < pipe.top || bird.y + bird.h > canvas.height - pipe.bottom)
        ) {
          gameOver();
        }
      }

      pipes = pipes.filter(pipe => pipe.x + pipe.w > 0);
    }

    function updateGame() {
      if (!gameRunning) return;

      ctx.clearRect(0, 0, canvas.width, canvas.height);
      bird.velocity += gravity;
      bird.y += bird.velocity;

      if (bird.y + bird.h > canvas.height || bird.y < 0) {
        gameOver();
      }

      drawBird();
      updatePipes();
      drawPipes();

      frame++;
      requestAnimationFrame(updateGame);
    }

    function gameOver() {
      gameRunning = false;
      canvas.style.display = "none";
      document.getElementById("shop").style.display = "block";
      dabloonCount.textContent = dabloons;
    }

    function restartGame() {
      document.getElementById("shop").style.display = "none";
      canvas.style.display = "block";
      bird.y = 250;
      bird.velocity = 0;
      pipes = [];
      frame = 0;
      gameRunning = true;
      requestAnimationFrame(updateGame);
    }

    function buySkin(name) {
      if (name === "gold" && dabloons >= 20) {
        alert("Golden bird equipped!");
        dabloons -= 20;
      } else if (name === "doge" && dabloons >= 30) {
        alert("Doge flyer unlocked!");
        dabloons -= 30;
      } else {
        alert("Not enough dabloons!");
      }
      dabloonCount.textContent = dabloons;
    }

    document.body.addEventListener("touchstart", () => {
      if (gameRunning) bird.velocity = -8;
    });
  </script>
</body>
</html>